<nz-layout class="layout">
  <nz-sider nzwidth="236px" class="ant-layout-sider menu-sidebar hide-for-small hide-for-medium show-for-large ant-layout-sider-dark" style="flex: 0 0 236px; max-width: 236px; min-width: 236px; width: 236px;">
    <div class="logo">
      <img src="../../../assets/images/logo/logo-system.png" alt="Logo">
    </div>
    <div class="custom-dark-menu">
      <ul nz-menu nzTheme="dark" nzMode="inline">
        <li nz-submenu nzTitle="Quản lý bãi xe">
          <ul>
            <li nz-menu-item [routerLink]="'/dashboard'">
              <span nz-icon nzType="dashboard" nzTheme="fill"></span>
              <span>Trang chủ</span>
            </li>
            <li nz-submenu nzTitle="Báo cáo" nzIcon="line-chart">
              <ul>
                <li nz-menu-item [routerLink]="">Xe vào bãi</li>
                <li nz-menu-item [routerLink]="">Xe đã ra</li>
                <li nz-menu-item [routerLink]="">Sự kiện cảnh báo</li>
                <li nz-menu-item [routerLink]="">Báo cáo doanh thu</li>
              </ul>
            </li>
          </ul>
        </li>
        <li nz-submenu nzTitle="Quản lý khách hàng">
          <ul>
            <li nz-menu-item [routerLink]="'/customer-groups'">
              <span nz-icon nzType="github" nzTheme="fill"></span>
              <span>Nhóm khách hàng</span> 
            </li>
            <li nz-menu-item [routerLink]="'/customers'">
              <span nz-icon nzType="gitlab" nzTheme="fill"></span>
              <span>Khách hàng</span>
            </li>
          </ul>
        </li>
        <li nz-submenu nzTitle="Quản lý thẻ">
          <ul>
            <li nz-menu-item [routerLink]="'/card-groups'">
              <span nz-icon nzType="apple" nzTheme="fill"></span>
              <span>Nhóm thẻ</span>
            </li>
            <li nz-menu-item [routerLink]="'/cards'">
              <span nz-icon nzType="android" nzTheme="fill"></span>
              <span>Thẻ</span>
            </li>
          </ul>
        </li>
        <li nz-submenu nzTitle="Quản lý thiết bị">
          <ul>
            <li nz-menu-item [routerLink]="'/gates'">
              <span nz-icon nzType="bank" nzTheme="fill"></span>
              <span>Cổng</span>
            </li>
            <li nz-menu-item [routerLink]="'/computers'">
              <span nz-icon nzType="laptop" nzTheme="outline"></span>
              <span>Máy tính</span>
            </li>
            <li nz-menu-item [routerLink]="'/cameras'">
              <span nz-icon nzType="camera" nzTheme="fill"></span>
              <span>Camera</span>
            </li>
            <li nz-menu-item [routerLink]="'/control_units'">
              <span nz-icon nzType="control" nzTheme="fill"></span>
              <span>Bộ điều khiển</span>
            </li>
            <li nz-menu-item [routerLink]="'/lanes'">
              <span nz-icon nzType="sliders" nzTheme="fill"></span>
              <span>Làn</span>
            </li>
            <li nz-menu-item [routerLink]="'/leds'">
              <span nz-icon nzType="bulb" nzTheme="fill"></span>
              <span>Led</span>
            </li>
          </ul>
        </li>
        <li nz-submenu nzTitle="Quản lý tài khoản">
          <ul>
            <li nz-menu-item>
              <span nz-icon nzType="safety-certificate" nzTheme="fill"></span>
              <span>Quyền hạn</span>
            </li>
            <li nz-menu-item>
              <span nz-icon nzType="team" nzTheme="outline"></span>
              <span>Nhóm người dùng</span>
            </li>
            <li nz-menu-item>
              <span nz-icon nzType="user" nzTheme="outline"></span>
              <span>Người dùng</span>
            </li>
          </ul>
        </li>
        <li nz-menu-item>
          <span class="custom-icon">
            <img src="../../../assets/images/logo/ic-cms.svg" width="20px" alt="CMS">
          </span>
          <span style="color: #f15922; font-weight: 900; margin-left: 10px;">i</span>
          <span style="color: #6abcff; font-weight: bold;">Parking</span>
        </li>
      </ul>
  </div>
  </nz-sider>
  <nz-layout class="ant-layout right-layout">
    <nz-header class="ant-layout-header">
        <div>
          <button nz-button nzType="primary" class="ant-btn1">
            <span nz-icon nzType="search" style="color: #637381;">
            </span>
            <span style="color:#637381 ;">Tìm kiếm thư mục</span>
          </button>
        </div>
        <div>
          <span style="margin-right: 15px;" nz-dropdown nzplacement="bottomRight">Admin</span>
        </div>
    </nz-header>
    <nz-content>
      <nz-breadcrumb>
        <div nz-flex nzalign="center" class="ant-flex breadcrumb-wrapper ant-flex-justify-normal ant-flex-align-center ant-flex-wrap-nowrap" style="gap: 0px; flex: unset;">
          <div nz-flex nzalign="center" class="ant-flex ant-flex-justify-normal ant-flex-align-center ant-flex-wrap-nowrap" style="color: #041f46 !important; font-weight: 500; font-size: 16px; gap: 0px; flex: unset;">
            <span>Thiết bị</span>
            <nz-divider nztype="vertical" class="ant-divider ant-divider-vertical"></nz-divider>
          </div>
          <nz-breadcrumb-item class="ng-star-inserted">
            <span class="ant-breadcrumb-link ng-star-inserted">
              <a href="/#/lanes">Làn</a>
            </span>
          </nz-breadcrumb-item>
        </div>
      </nz-breadcrumb>
      <div class="inner-content">
          <nz-card class="ant-card card-wrapper-content ant-card-bordered">
              <div class="ant-card-body" style="padding: 24px 0px;"> 
                  <nz-row class="ant-row filter-row ng-star-inserted" style="margin: -12px -6px;">
                      <nz-col nzxl="8" nzlg="8" nzmd="12" nzsm="24" nzxs="24" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-12 ant-col-lg-8 ant-col-xl-8" style="padding: 12px 6px;">
                          <fieldset>
                              <label for="keyword"class="input-label" style="color: #0c68e9;">Từ khóa</label>
                              <nz-input-group nzsearch class="ant-input-search-enter-button ant-input-search ant-input-group-wrapper">
                                  <span class="ant-input-wrapper ant-input-group ng-star-inserted">
                                      <input type="text" nz-input id="keyword" class="ant-input ng-valid ant-input-stepperless ng-star-inserted ng-touched ng-dirty" placeholder="Từ khóa..." [(ngModel)]="searchKeyword">
                                      <span nz-input-group-slot type="addon" class="ant-input-group-addon ng-star-inserted">
                                          <button nz-button nzType="primary" (click)="onSearch()" class="ant-btn ant-btn-primary ant-input-search-button ant-btn-icon-only ng-star-inserted">
                                              <span nz-icon nzType="search" class="anticon anticon-search"></span>
                                          </button>
                                      </span>
                                  </span>
                              </nz-input-group>
                          </fieldset>
                      </nz-col>
                      <nz-col nzxl="16" nzlg="16" nzmd="12" nzsm="24" nzxs="24" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-12 ant-col-lg-16 ant-col-xl-16" style="padding: 12px 6px;">
                          <table-action>
                              <div nz-row class="ant-row">  
                                  <div nz-col nzxl="24" nzlg="24" nzmd="0" nzsm="0" nzxs="0" class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-0 ant-col-lg-24 ant-col-xl-24">
                                      <div nz-flex nzgap="6px" class="ant-flex wrapper-table-action ant-flex-justify-end ant-flex-align-center ant-flex-wrap-nowrap ng-star-inserted" style="width: 100%; height: 100%; gap: 6px; flex: unset;">
                                          <button (click)="loadLanes()" nz-button nztype="text" class="ant-btn load-btn ant-btn-text">
                                              <span nz-icon class="anticon">
                                                  <fa-icon class="ng-fa-icon">
                                                      <img src="../../../assets/images/logo/rotate-solid.svg" style="height: 14px; width: 14px;" alt="">                                
                                                  </fa-icon>
                                              </span>
                                              <span class="ng-star-inserted">Tải lại</span>
                                          </button> 
                                          <nz-divider class="ant-divider ant-divider-vertical ng-star-inserted"></nz-divider>
                                          <button (click)="showAddLaneModal()" nz-button nztype="primary" class="ant-btn add-btn ant-btn-primary ng-star-inserted"> 
                                              <span nz-icon class="anticon">
                                                  <fa-ico class="ng-fa-icon">
                                                      <img src="../../../assets/images/logo/plus-solid.svg" style="height: 14px; width: 14px;" alt="">
                                                  </fa-ico>
                                              </span>
                                              <span class="ng-star-inserted">Thêm mới</span>
                                          </button>
                                      </div>
                                  </div>
                              </div>
                          </table-action>
                      </nz-col>
                  </nz-row>
                  <nz-table
                    #ledTable
                    [nzData]="lanes"
                    [nzTotal]="total"
                    [nzPageSize]="pageSize"
                    [nzPageIndex]="pageIndex"
                    [nzFrontPagination]="false"
                    [nzShowSizeChanger]="true"
                    [nzShowTotal]="paginationTemplate"
                    (nzQueryParams)="onQueryParamsChange($event)"
                    [nzLoading]="loading"
                  >
                    <thead>
                      <tr>
                        <th style="width: 60px; min-width: 60px;">#</th>
                        <th>Tên</th>
                        <th>Mã</th>
                        <th>Loại</th>
                        <th>Máy tính</th>
                        <th>Tự động mở barrier</th>
                        <th style="text-align: center;">Loop</th>
                        <th style="width: 60px; min-width: 60px; text-align: center;">TT</th>
                        <th style="width: 130px; min-width: 130px; text-align: center;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let lane of lanes; let i = index">
                        <td>{{ (pageIndex - 1) * pageSize + i + 1 }}</td>
                        <td>{{ lane.name }}</td>
                        <td>{{ lane.code }}</td>
                        <td>  
                          <nz-tag style="border-color: #f6ffed; border-radius: 8px; font-size: 12px;"
                            *ngIf="getLaneTypeOption(lane.type) as opt"
                            [nzColor]="opt.color"
                          >
                            {{ opt.label }}
                          </nz-tag>
                        </td>
                        <td>{{ getComputerNameById(lane.computerId) }}</td>
                        <td>
                          <nz-badge
                            *ngIf="getAutoOpenBarrierOption(lane.autoOpenBarrier) as opt"
                            [nzStatus]="opt.status"
                            [nzText]="opt.shortLabel"
                          ></nz-badge>
                        </td>
                        <td style="text-align: center;">
                          <nz-tag [nzColor]="lane.loop ? '#52c41a' : '#637381'" style="display: inline-flex; align-items: center; gap: 4px; border-radius: 8px; font-size: 12px;">
                            <nz-icon
                              [nzType]="lane.loop ? 'check-circle' : 'close-circle'"
                            ></nz-icon>
                            {{ lane.loop ? 'Đang sử dụng' : 'Không sử dụng' }}
                          </nz-tag>
                        </td>                        
                        <td style="text-align: center;">
                          <i *ngIf="lane.status; else falseIcon" nz-icon nzType="check-circle" class="icon-green" style="font-size: 18px;"></i>
                          <ng-template #falseIcon>
                            <i nz-icon nzType="close-circle" class="icon-red" style="font-size: 18px;"></i>
                          </ng-template>
                        </td>
                        <td style="text-align: center;">
                          <button nz-button class="ant-btn edit-btn ant-btn-icon-only" (click)="updateLane(lane.id)">
                            <span nz-icon nzType="edit" nzTheme="outline"></span>
                          </button>
                          <button nz-button class="ant-btn delete-btn ant-btn-icon-only" (click)="deleteLane(lane.id)">
                            <span nz-icon nzType="delete" nzTheme="outline"></span>
                          </button>
                          <button nz-button class="ant-btn ant-btn-icon-only" [ngClass]="lane.status ? 'enabled-btn' : 'disabled-btn'" (click)="toggleLaneStatus(lane.id)">
                            <span nz-icon [nzType]="lane.status ? 'lock' : 'unlock'" nzTheme="outline"></span>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                    <ng-template #paginationTemplate>
                      Tổng số {{ total }} dữ liệu
                    </ng-template>
                  </nz-table>
                  <nz-float-button *ngIf="isVisible"
                  [nzType]="'primary'"
                  [nzShape]="'circle'"
                  [nzTooltipTitle]="'Lên đầu trang'"
                  (click)="backToTop()"
                  >
                    <button nz-button class="ant-btn">
                      <nz-float-button-content>
                        <div class="ant-float-btn-icon ng-star-inserted">
                          <nz-icon nzType="vertical-align-top" nztheme="outline" class="anticon"></nz-icon>
                        </div>
                      </nz-float-button-content>
                    </button>
                  </nz-float-button>
              </div>
          </nz-card>
      </div>
    </nz-content>
  </nz-layout>
</nz-layout>


<nz-modal [nzContent]="addLaneTpl" [(nzVisible)]="isAddModalVisible" nzTitle="Thêm mới Làn" nzWidth="60vw" nzOktext="Lưu" nzCancelText="Hủy bỏ" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()"></nz-modal>
  <ng-template #addLaneTpl>
    <form [formGroup]="laneForm">
      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneName" class="required-label" style="margin-bottom: 10px;">Tên</label>
            <input id="laneName" nz-input formControlName="name" style="border-radius: 8px;"/>
          </div>
        </div>
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneCode" class="required-label" style="margin-bottom: 10px;">Mã</label>
            <input id="laneCode" nz-input formControlName="code" style="border-radius: 8px;"/>
          </div>
        </div>
      </div>

      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneComputerId" class="required-label" style="margin-bottom: 10px;">Máy tính</label>
            <nz-select formControlName="computerId" style="width: 100%;" nzPlaceHolder="Máy tính">
              <nz-option *ngFor="let computer of computers" [nzValue]="computer.id" [nzLabel]="computer.name" style="border-radius: 8px;"></nz-option>
            </nz-select>
          </div>
        </div>
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneType" class="required-label" style="margin-bottom: 10px;">Loại</label>
            <nz-select id="laneType" formControlName="type" style="width: 100%;">
              <nz-option *ngFor="let type of laneTypes" [nzValue]="type.value" [nzLabel]="type.label"></nz-option>
            </nz-select>
          </div>
        </div>
      </div>

      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneName" style="margin-bottom: 10px;">Làn đảo</label>
            <nz-select formControlName="reverseLane" style="width: 100%;">
              <nz-option *ngFor="let lane of lanes" [nzValue]="lane.id" [nzLabel]="lane.name"></nz-option>
            </nz-select>
          </div>
        </div>
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneAutoOpenBarrier" style="margin-bottom: 10px;">Tự động mở barrier</label>
            <nz-select id="laneAutoOpenBarrier" formControlName="autoOpenBarrier" style="width: 100%;">
              <nz-option
                *ngFor="let type of laneAutoOpenBarrierOptions"
                [nzValue]="type.value"
                [nzLabel]="type.label"
              >
                <ng-template #customTemplate>
                  <nz-badge
                    [nzStatus]="type.status"
                    [nzText]="type.label"
                  ></nz-badge>
                </ng-template>
              </nz-option>
            </nz-select>                            
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="laneLoop" style="margin-bottom: 10px;">Sử dụng loop:</label>
        <label nz-checkbox formControlName="loop" style="margin-left: 10px;" ></label>
      </div>

      <div class="ant-row" style="margin-bottom: 10px;">
        <div nz-col [nzSpan]="24" style="margin-bottom: -10px;">
          <label>
            <p nz-typography nzEllipsis>Camera</p>
          </label>
        </div>
        <div nz-row class="ant-row child-form-header" style="width: 100%; margin-bottom: 10px;">
          <div nz-col [nzSpan]="7">Tên</div>
          <div nz-col [nzSpan]="7">Mục đích</div>
          <div nz-col [nzSpan]="7">Vị trí hiển thị</div>
          <div nz-col [nzSpan]="2"></div>
          <div nz-col [nzSpan]="1" class="text-right" style="background-color: unset;">
            <button nz-button nzType="primary" nzShape="circle" (click)="addLaneCamera()" [disabled]="filteredCameras.length === 0">
              <span nz-icon nzType="plus"></span>
            </button> 
          </div>
        </div>
      </div>

      <div formArrayName="laneCameras">
        <div [nzGutter]="12" *ngFor="let cameraGroup of laneCameras.controls; let i = index" [formGroupName]="i" nz-row style="margin-bottom: 10px;">
          <div nz-col [nzSpan]="7">
            <nz-select formControlName="cameraId" style="width: 100%" >
              <nz-option *ngFor="let camera of filteredCameras" [nzValue]="camera.id" [nzLabel]="camera.name"></nz-option>
            </nz-select>
          </div>
      
          <div nz-col [nzSpan]="7">
            <nz-select formControlName="purpose" style="width: 100%">
              <nz-option *ngFor="let purpose of laneCameraPurposes" [nzValue]="purpose.value" [nzLabel]="purpose.label" style="border-radius: 8px;"></nz-option>
            </nz-select>
          </div>
      
          <div nz-col [nzSpan]="7">
            <nz-select formControlName="displayPosition" style="width: 100%">
              <nz-option *ngFor="let pos of displayPositions" [nzValue]="pos" [nzLabel]="pos" style="border-radius: 8px;"></nz-option>
            </nz-select>
          </div>

          <div nz-col [nzSpan]="2"></div>
      
          <div nz-col [nzSpan]="1"  class="text-right" style="background-color: unset;">
            <button nz-button nzType="primary" nzShape="circle" nzDanger (click)="removeLaneCamera(i)">
              <span nz-icon nzType="minus"></span>
            </button> 
          </div>
        </div>
      </div>
      
      <div class="ant-row">
        <div nz-col [nzSpan]="24">
          <label style="font-weight: 500; margin-bottom: -10px;">
            <p nz-typography nzEllipsis>Bộ điều khiển</p>
          </label>
        </div>
        <div nz-row class="ant-row child-form-header" style="width: 100%; margin-bottom: 20px;">
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Tên</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Reader</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Input</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Barrier</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Cảnh báo</div>
        </div>
      </div>

      <div formArrayName="laneControlUnits">
        <div *ngFor="let controlUnitGroup of laneControlUnits.controls; let i = index" [formGroupName]="i" style="margin-bottom: 10px;">
          <div nz-row [nzGutter]="16" style="align-items: center; margin-bottom: 10px;" >
            
            <div nz-col nzFlex="1">
              <input nz-input [value]="controlUnitGroup.get('name')?.value" readonly style="width: 100%; border-radius: 8px;">
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="reader" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="input" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="barrier" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="alarm" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
            
          </div>
        </div>
      </div>
    </form>
  </ng-template>




<nz-modal [nzContent]="editLaneTpl" [(nzVisible)]="isEditModalVisible" nzTitle="Cập nhật Camera" nzWidth="60vw" nzOktext="Lưu" nzCancelText="Hủy bỏ" (nzOnCancel)="handleEditCancel()" (nzOnOk)="handleEditOk()"></nz-modal>
  <ng-template #editLaneTpl>
    <form [formGroup]="editLaneForm"> 
      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneName" class="required-label" style="margin-bottom: 10px;">Tên</label>
            <input id="laneName" nz-input formControlName="name" style="border-radius: 8px;"/>
          </div>
        </div>
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneCode" class="required-label" style="margin-bottom: 10px;">Mã</label>
            <input id="laneCode" nz-input formControlName="code" style="border-radius: 8px;"/>
          </div>
        </div>
      </div>

      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneComputerId" class="required-label" style="margin-bottom: 10px;">Máy tính</label>
            <nz-select formControlName="computerId" style="width: 100%;" nzPlaceHolder="Máy tính">
              <nz-option *ngFor="let computer of computers" [nzValue]="computer.id" [nzLabel]="computer.name"></nz-option>
            </nz-select>
          </div>
        </div>
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneType" class="required-label" style="margin-bottom: 10px;">Loại</label>
            <nz-select id="laneType" formControlName="type" style="width: 100%;">
              <nz-option *ngFor="let type of laneTypes" [nzValue]="type.value" [nzLabel]="type.label"></nz-option>
            </nz-select>
          </div>
        </div>
      </div>

      <div nz-row [nzGutter]="16" style="margin-top: 16px;">
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneName" style="margin-bottom: 10px;">Làn đảo</label>
            <nz-select formControlName="reverseLane" style="width: 100%;">
              <nz-option *ngFor="let lane of lanes" [nzValue]="lane.id" [nzLabel]="lane.name"></nz-option>
            </nz-select>
          </div>
        </div>
        <div nz-col [nzSpan]="12">
          <div class="form-group">
            <label for="laneAutoOpenBarrier" style="margin-bottom: 10px;">Tự động mở barrier</label>
            <nz-select id="laneAutoOpenBarrier" formControlName="autoOpenBarrier" style="width: 100%;">
              <nz-option *ngFor="let type of laneAutoOpenBarrierOptions" [nzValue]="type.value" [nzLabel]="type.label"></nz-option>
            </nz-select>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="laneLoop" style="margin-bottom: 10px;">Sử dụng loop:</label>
        <label nz-checkbox formControlName="loop" style="margin-left: 10px;" ></label>
      </div>

      <div class="ant-row" style="margin-bottom: 10px;">
        <div nz-col [nzSpan]="24" style="margin-bottom: -10px;">
          <label>
            <p nz-typography nzEllipsis>Camera</p>
          </label>
        </div>
        <div nz-row class="ant-row child-form-header" style="width: 100%; margin-bottom: 10px;">
          <div nz-col [nzSpan]="7">Tên</div>
          <div nz-col [nzSpan]="7">Mục đích</div>
          <div nz-col [nzSpan]="7">Vị trí hiển thị</div>
          <div nz-col [nzSpan]="2"></div>
          <div nz-col [nzSpan]="1" class="text-right" style="background-color: unset;">
            <button nz-button nzType="primary" nzShape="circle" (click)="addEditLaneCamera()" [disabled]="filteredCameras.length === 0">
              <span nz-icon nzType="plus"></span>
            </button> 
          </div>
        </div>
      </div>

      <div formArrayName="laneCameras">
        <div [nzGutter]="12" *ngFor="let cameraGroup of editLaneCameras.controls; let i = index" [formGroupName]="i" nz-row style="margin-bottom: 10px;">
          <div nz-col [nzSpan]="7">
            <nz-select formControlName="cameraId" style="width: 100%" >
              <nz-option *ngFor="let camera of filteredCameras" [nzValue]="camera.id" [nzLabel]="camera.name"></nz-option>
            </nz-select>
          </div>
      
          <div nz-col [nzSpan]="7">
            <nz-select formControlName="purpose" style="width: 100%">
              <nz-option *ngFor="let purpose of laneCameraPurposes" [nzValue]="purpose.value" [nzLabel]="purpose.label" style="border-radius: 8px;"></nz-option>
            </nz-select>
          </div>
      
          <div nz-col [nzSpan]="7">
            <nz-select formControlName="displayPosition" style="width: 100%">
              <nz-option *ngFor="let pos of displayPositions" [nzValue]="pos" [nzLabel]="pos" style="border-radius: 8px;"></nz-option>
            </nz-select>
          </div>

          <div nz-col [nzSpan]="2"></div>
      
          <div nz-col [nzSpan]="1"  class="text-right" style="background-color: unset;">
            <button nz-button nzType="primary" nzShape="circle" nzDanger (click)="removeEditLaneCamera(i)">
              <span nz-icon nzType="minus"></span>
            </button> 
          </div>
        </div>
      </div>
      
      <div class="ant-row">
        <div nz-col [nzSpan]="24">
          <label style="font-weight: 500; margin-bottom: -10px;">
            <p nz-typography nzEllipsis>Bộ điều khiển</p>
          </label>
        </div>
        <div nz-row class="ant-row child-form-header" style="width: 100%; margin-bottom: 20px;">
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Tên</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Reader</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Input</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Barrier</div>
          <div nz-col nzflex="1" class="ant-col" style="flex: 1 1 0%;">Cảnh báo</div>
        </div>
      </div>

      <div formArrayName="laneControlUnits">
        <div *ngFor="let controlUnitGroup of editLaneControlUnits.controls; let i = index" [formGroupName]="i" style="margin-bottom: 10px;">
          <div nz-row [nzGutter]="16" style="align-items: center; margin-bottom: 10px;" >
            
            <div nz-col nzFlex="1">
              <input nz-input [value]="controlUnitGroup.get('name')?.value" readonly style="width: 100%; border-radius: 8px;">
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="reader" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="input" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="barrier" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
      
            <div nz-col nzFlex="1">
              <nz-select formControlName="alarm" style="width: 100%" nzMode="multiple">
                <nz-option *ngFor="let num of [0,1,2,3,4,5]" [nzValue]="num" [nzLabel]="num.toString()"></nz-option>
              </nz-select>
            </div>
            
          </div>
        </div>
      </div>
    </form>
  </ng-template> 
